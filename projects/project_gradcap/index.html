<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Grad Cap Light Display | Joey Costello</title> <meta name="author" content="Joey Costello"/> <meta name="description" content="a custom circuit board with 100 rgb leds"/> <meta name="keywords" content="brain-computer-interface, machine-learning, signal-processing"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß†</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://jtcostello.github.io/projects/project_gradcap/"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Joey¬†</span>Costello</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/research/">research</a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/photography/">photography</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Grad Cap Light Display</h1> <p class="post-description">a custom circuit board with 100 rgb leds</p> </header> <article> <p>May 2020</p> <div class="row justify-content-center"> <div class="col-sm mt-3 mt-md-0 pb-3"> <div class="embed-responsive embed-responsive-16by9"> <iframe class="embed-responsive-item" src="https://www.youtube.com/embed/-vmMZ31GtQo?autoplay=1" frameborder="0" allowfullscreen=""></iframe> </div> </div> </div> <div class="row mx-auto align-items-center"> <div class="col-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/colorfullboard_crop-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/colorfullboard_crop-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/colorfullboard_crop-1400.webp"></source> <img src="/assets/img/gradcap/colorfullboard_crop.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="colorful board" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-5 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/me%20holding%20board-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/me%20holding%20board-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/me%20holding%20board-1400.webp"></source> <img src="/assets/img/gradcap/me%20holding%20board.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="final board" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Back in February, I started designing a light-up graduation cap for my undergrad graduation ceremony scheduled for May (ultimately cancelled because of the pandemic). As an electrical engineer and soon-to-be neuroengineering grad student, I took inspiration from circuit-brain designs <a href="https://www.shutterstock.com/video/clip-1020844972-creative-circuit-brain-semispheres-4k-uhd-animation" target="_blank" rel="noopener noreferrer">like this </a>. Others <a href="https://hackaday.io/project/11725-wireless-led-matrix-grad-cap-display" target="_blank" rel="noopener noreferrer">have put LED matrix displays</a> on their grad cap and programmed cool animations across the screen. But this seemed too easy and all designs disappeared as soon as it turned off. I wanted something that could light up with animations, but also have a permanent design for display. I settled on creating a custom circuit board with small LEDs animating a printed design.</p> <p><br></p> <h4 id="designing-the-board">Designing the board</h4> <p>After drawing a few sketches including a full-size drawing, I created the design in Photoshop. The mortarboard has an inconvenient 0.75in hole for the tassel so I made sure it was centered nicely within the M. I exported the design as an SVG and imported into Eagle.</p> <div class="row align-items-center"> <div class="col-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/00%20stick%20note%20sketch-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/00%20stick%20note%20sketch-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/00%20stick%20note%20sketch-1400.webp"></source> <img src="/assets/img/gradcap/00%20stick%20note%20sketch.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/01%20big%20sketch-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/01%20big%20sketch-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/01%20big%20sketch-1400.webp"></source> <img src="/assets/img/gradcap/01%20big%20sketch.jpg" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="sketch 2" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/03%20black%20letters%20with%20M-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/03%20black%20letters%20with%20M-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/03%20black%20letters%20with%20M-1400.webp"></source> <img src="/assets/img/gradcap/03%20black%20letters%20with%20M.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="psd design" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-3 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/gradcapoverview-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/gradcapoverview-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/gradcapoverview-1400.webp"></source> <img src="/assets/img/gradcap/gradcapoverview.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="psd design" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>I chose to use WS2812b RGB leds, which are commonly used in LED light strips. I went with the 3.5mm SMD LEDs which were the smallest I could reliably hand-solder (for future board iterations I may try the 1.5mm LEDs for a higher resolution display). The LEDs are chained together and only need a single data line for control, making it very easy to created individually-addressable displays with a few lines of code. I ended up using 96 LEDs evenly spaced around the board to animate the ‚Äúneural activity‚Äù.</p> <p>For the microcontroller I chose the Atmel328p, the same as on the Arduino Uno, allowing for compatibility with the standard Arduino IDE. A small lipo battery would power the board and fit on the underside of the grad cap, hidden from view.</p> <p>I created the schematic and laid out the full board in Eagle. I added a pin header to program the microcontroller and breakout connections to manually control the LEDs (which were very useful when the microcontroller wasn‚Äôt working).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/08%20micro%20schematic-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/08%20micro%20schematic-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/08%20micro%20schematic-1400.webp"></source> <img src="/assets/img/gradcap/08%20micro%20schematic.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="sketch 1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/09%20leds%20schematic-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/09%20leds%20schematic-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/09%20leds%20schematic-1400.webp"></source> <img src="/assets/img/gradcap/09%20leds%20schematic.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" title="sketch 1" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>After finalizing the PCB design, the next challenge was finding a manufacturer to make it for a reasonable price. OSHPark and a couple others would charge almost $500 for the 100in2 board. I went with JLCPCB who produced the 5 copies of the full board with faster shipping for $52. Even in mid-March with Covid in full-swing in China, the boards arrived in only a couple weeks.</p> <div class="row mx-auto"> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/20%20gradcap_schematic_top-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/20%20gradcap_schematic_top-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/20%20gradcap_schematic_top-1400.webp"></source> <img src="/assets/img/gradcap/20%20gradcap_schematic_top.png" class="img-fluid rounded" width="auto" height="auto" title="schematic" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/21%20gradcap_schematic_bottom-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/21%20gradcap_schematic_bottom-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/21%20gradcap_schematic_bottom-1400.webp"></source> <img src="/assets/img/gradcap/21%20gradcap_schematic_bottom.png" class="img-fluid rounded" width="auto" height="auto" title="schematic" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Once the boards and all components arrived, I got started on the 450+ solder connections. I connected an external Arduino to the LED input pins and verified the connections each time I added another LED. The main problem with using only a single data-line for all the LEDs is if a single connection is bad, then the whole string of lights fails (but it‚Äôs obvious where the bad connection lies).</p> <div class="row align-items-center"> <div class="col-sm-5 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/30%20assembly%201-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/30%20assembly%201-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/30%20assembly%201-1400.webp"></source> <img src="/assets/img/gradcap/30%20assembly%201.jpg" class="img-fluid rounded mx-auto d-block" width="auto" height="auto" title="assembly" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/33%203%20assembly%20lapse%20x4%20cropped%20gif.gif-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/33%203%20assembly%20lapse%20x4%20cropped%20gif.gif-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/33%203%20assembly%20lapse%20x4%20cropped%20gif.gif-1400.webp"></source> <img src="/assets/img/gradcap/33%203%20assembly%20lapse%20x4%20cropped%20gif.gif" class="img-fluid rounded mx-auto d-block" width="auto" height="auto" title="assembly" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><br></p> <h4 id="programming-animations">Programming animations</h4> <p>Now the fun part: programming the light animations. Adafruit‚Äôs Neopixel library made it easy to set each LED‚Äôs color and brightness. The main challenge was that the LEDs weren‚Äôt in a convient grid, but rather scattered randomly around the board. To solve this, I recorded each LED‚Äôs XY coordinates and it‚Äôs ‚Äúneural tree‚Äù location (tree number and depth, see figure below), and stored these in an array. For simple animations like the exploding wave, an LED‚Äôs color is calculated based on its location and the current timestep. For the neural activity animation, each ‚Äútree‚Äù is activated at a random time, with maximal activation starting at depth 1 and flowing up to depth 5 smoothly.</p> <p>But what‚Äôs a Michigan cap without a Go Blue? I converted the G O B L U E text into a 20x85 bitmap that scrolls across the display. At a single timestep, a 20x20 slice is taken out of the full bitmap. Each LED‚Äôs color is determined by rounding its XY position to the nearest 20x20 grid location, then extracting the 1/0 at the location in the current 20x20 slice. Iterating slices across the full 85 width shows the full GOBLUE.</p> <div class="row"> <div class="col-sm-4 mt-3 mt-md-0 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/37%20tree%20depths-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/37%20tree%20depths-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/37%20tree%20depths-1400.webp"></source> <img src="/assets/img/gradcap/37%20tree%20depths.png" class="img-fluid rounded mx-auto d-block" width="auto" height="auto" title="LED tree and depths" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm-6 mt-3 mt-md-0 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/38%20goblue%20matrix-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/38%20goblue%20matrix-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/38%20goblue%20matrix-1400.webp"></source> <img src="/assets/img/gradcap/38%20goblue%20matrix.png" class="img-fluid rounded mx-auto d-block" width="auto" height="auto" title="data matrix" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>I hot-glued the PCB onto the mortarboard with the battery on the underside. I have yet test the battery life, but I expect it to give at least an hour of display time.</p> <p>The display turned out exactly how I‚Äôd pictured it and I hope I can wear it to a ceremony in the future. There are many more possibilities for animations, especially since it‚Äôs a full-color display (not limited solely to maize and blue). I‚Äôm now working on making a wooden frame to display it on a wall when not being worn. An additional future project might involve placing EEG electrodes inside the cap to display real brain activity with the lights. Perhaps that‚Äôs a project for my PhD graduation cap.</p> <div class="row"> <div class="col-6 mt-3 mt-md-0 mx-auto"> <figure> <picture> <source class="responsive-img-srcset" media="(max-width: 480px)" srcset="/assets/img/gradcap/outsidepic-480.webp"></source> <source class="responsive-img-srcset" media="(max-width: 800px)" srcset="/assets/img/gradcap/outsidepic-800.webp"></source> <source class="responsive-img-srcset" media="(max-width: 1400px)" srcset="/assets/img/gradcap/outsidepic-1400.webp"></source> <img src="/assets/img/gradcap/outsidepic.jpg" class="img-fluid rounded mx-auto d-block" width="auto" height="auto" title="LED tree and depths" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2023 Joey Costello. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>